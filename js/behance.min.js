/*
 * FlyJSONP v0.2
 * http://alotaiba.github.com/FlyJSONP
 * 
 * FlyJSONP is a small JavaScript library, that allows you to do
 * cross-domain GET and POST requests with remote services that support
 * JSONP, and get a JSON response.
 * 
 * Copyright (c) 2011 Abdulrahman Al-Otaiba
 * Dual-licensed under MIT and GPLv3.
 */var FlyJSONP=function(e){"use strict";var t,n,r,i,s,o,u,a,f;n=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n};r=function(n,r){t.log("Garbage collecting!");r.parentNode.removeChild(r);e[n]=undefined;try{delete e[n]}catch(i){}};i=function(e,t){var n="",r,i;for(r in e)if(e.hasOwnProperty(r)){r=t?encodeURIComponent(r):r;i=t?encodeURIComponent(e[r]):e[r];n+=r+"="+i+"&"}return n.replace(/&$/,"")};s=function(){var e="",t=[],n="0123456789ABCDEF",r=0;for(r=0;r<32;r+=1)t[r]=n.substr(Math.floor(Math.random()*16),1);t[12]="4";t[16]=n.substr(t[16]&3|8,1);e="flyjsonp_"+t.join("");return e};o=function(e,n){t.log(n);typeof e!="undefined"&&e(n)};u=function(e,n){t.log("GET success");typeof e!="undefined"&&e(n);t.log(n)};a=function(e,n){t.log("POST success");typeof e!="undefined"&&e(n);t.log(n)};f=function(e){t.log("Request complete");typeof e!="undefined"&&e()};t={};t.options={debug:!1};t.init=function(e){var n;t.log("Initializing!");for(n in e)e.hasOwnProperty(n)&&(t.options[n]=e[n]);t.log("Initialization options");t.log(t.options);return!0};t.log=function(n){e.console&&t.options.debug&&e.console.log(n)};t.get=function(l){l=l||{};var c=l.url,h=l.callbackParameter||"callback",p=l.parameters||{},d=e.document.createElement("script"),v=s(),m="?";if(!c)throw new Error("URL must be specified!");p[h]=v;c.indexOf("?")>=0&&(m="&");c+=m+i(p,!0);e[v]=function(e){if(typeof e=="undefined")o(l.error,"Invalid JSON data returned");else if(l.httpMethod==="post"){e=e.query.results;if(!e||!e.postresult)o(l.error,"Invalid JSON data returned");else{e.postresult.json?e=e.postresult.json:e=e.postresult;a(l.success,e)}}else u(l.success,e);r(v,d);f(l.complete)};t.log("Getting JSONP data");d.setAttribute("src",c);e.document.getElementsByTagName("head")[0].appendChild(d);n(d,"error",function(){r(v,d);f(l.complete);o(l.error,"Error while trying to access the URL")})};t.post=function(e){e=e||{};var n=e.url,r=e.parameters||{},s,o,u={};if(!n)throw new Error("URL must be specified!");s=encodeURIComponent('select * from jsonpost where url="'+n+'" and postdata="'+i(r,!1)+'"');o="http://query.yahooapis.com/v1/public/yql?q="+s+"&format=json"+"&env="+encodeURIComponent("store://datatables.org/alltableswithkeys");u.url=o;u.httpMethod="post";typeof e.success!="undefined"&&(u.success=e.success);typeof e.error!="undefined"&&(u.error=e.error);typeof e.complete!="undefined"&&(u.complete=e.complete);t.get(u)};return t}(this);FlyJSONP.get({url:"http://www.behance.net/v2/users/seandrickson/projects",parameters:{api_key:"Am3dYZpehliXhXrGIB1Lq831ivWfmBQF"},success:function(e){if(e.http_code===200){var t=document,n,r=e.projects,i=t.getElementById("loading"),s=t.getElementById("portfolio");i.parentNode.removeChild(i);for(n in r){var o=t.createElement("div"),u=t.createElement("a"),a=t.createElement("img");a.setAttribute("src",r[n].covers[404]);a.setAttribute("alt",r[n].name);u.appendChild(a);u.setAttribute("href",r[n].url);o.appendChild(u);o.setAttribute("class","project one-fourth");s.appendChild(o)}}else this.error(e)},error:function(e){console.log(e)}});